<!DOCTYPE HTML>
<html>

<head>
    <meta charset="UTF-8">
    <title>의류수거함 어디있지?</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript>
        <link rel="stylesheet" href="assets/css/noscript.css" />
    </noscript>

    <style>
        #map {
            width: 70%;
            height: 300px;
            margin: auto;
        }
    </style>
    <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=2zcj0zqnez"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>

<body class="is-preload">
    <div class="container">
        <section class="section" id="section-3">
            <h1>오시는 길</h1>
            <div id="map"></div>
            <div id="markerCoordinates"></div>
            <code id="snippet" class="snippet"></code>
        </section>
    </div>

    <script>
        var mapOptions = {
            center: new naver.maps.LatLng(37.5665, 126.9780),
            zoom: 10
        };

        var map = new naver.maps.Map('map', mapOptions);

        $.ajax({
            url: 'data.csv',
            dataType: 'text',
            success: function (data) {
                var lines = data.split('\n');
                for (var i = 0; i < lines.length; i++) {
                    var lineData = lines[i].split(',');
                    var labelContent = parseFloat(lineData[0]);
                    var lat = parseFloat(lineData[1]);
                    var lng = parseFloat(lineData[2]);

                    var newMarkerOptions = {
                        position: new naver.maps.LatLng(lat, lng),
                        map: map
                    };

                    var newMarker = new naver.maps.Marker(newMarkerOptions);

                    var labelOptions = {
                        content: labelContent,
                        position: new naver.maps.LatLng(lat, lng),
                        map: map
                    };

                    var label = new naver.maps.Marker(labelOptions);
                    naver.maps.Event.addListener(newMarker, 'mouseover', function () {
                        label.setMap(map);
                    });
                    naver.maps.Event.addListener(newMarker, 'mouseout', function () {
                        label.setMap(null);
                    });

                    naver.maps.Event.addListener(newMarker, 'click', function (e) {
                        var markerPosition = e.coord;
                        var markerCoordinatesElement = document.getElementById('markerCoordinates');
                        markerCoordinatesElement.innerText = '클릭된 마커의 좌표: ' + markerPosition.toString();
                    });
                }
            }
        });
    </script>
</body>

</html>
